.global _start

.section .text

  movq root, %rdi
  xor %r8, %r8
  movl __ExpectedArraySize, %r8d
  movq $__ExpectedArray, %r9
  movq $0, %r10
  call rec

  cmp %r10, %r8
  jne bad_exit
  
  movq $60, %rax
  movq $0, %rdi
  syscall

bad_exit:
  movq $60, %rax
  movq $1, %rdi
  syscall

rec:
  pushq %rdi
  movq (%rdi), %r11
  cmp $0, %r11
  je skip_left
  movq %r11, %rdi
  call rec
  movq (%rsp), %rdi
skip_left:
  cmpq %r8, %r10
  je bad_exit
  movl 8(%rdi), %eax
  movl (%r9, %r10, 4), %edx
  cmpl %eax, %edx
  jne bad_exit
  inc %r10

  movq 12(%rdi), %r11
  cmp $0, %r11
  je skip_right
  movq %r11, %rdi
  call rec
skip_right:
  popq %rdi
  ret


.section .data
__ExpectedArray: .int -1181064550, -932591048, -883270465, -778490530, -767150020, -275222966, -261834377, -68966248, 82879995, 190592686, 229173210, 244719922, 349287804, 468566357, 619349691, 637591464, 835441217, 871453743, 914428626, 959340624, 1070671025, 1338061445, 1404316229, 2105625869, 2138007214

__ExpectedArraySize: .int 25
__Garbage_381653143: .byte 92, 200, 77
__Nodes:
.quad 0
.int -1181064550
.quad 0
.quad __Nodes + 240
.int 190592686
.quad __Nodes + 120
.quad __Nodes + 380
.int 914428626
.quad __Nodes + 260
.quad 0
.int 1070671025
.quad 0
.quad 0
.int 637591464
.quad 0
.quad __Nodes + 80
.int 835441217
.quad __Nodes + 420
.quad __Nodes + 220
.int 468566357
.quad 0
.quad 0
.int -883270465
.quad 0
.quad __Nodes + 320
.int -275222966
.quad __Nodes + 400
.quad 0
.int 244719922
.quad 0
.quad 0
.int -261834377
.quad 0
.quad 0
.int 229173210
.quad __Nodes + 280
.quad __Nodes + 160
.int 82879995
.quad 0
.quad 0
.int 959340624
.quad __Nodes + 60
.quad __Nodes + 180
.int 349287804
.quad 0
.quad __Nodes + 40
.int 1338061445
.quad __Nodes + 440
.quad 0
.int -767150020
.quad 0
.quad __Nodes + 0
.int -932591048
.quad __Nodes + 140
.quad 0
.int 2105625869
.quad __Nodes + 480
.quad __Nodes + 20
.int 619349691
.quad __Nodes + 100
.quad __Nodes + 200
.int -68966248
.quad 0
.quad 0
.int 871453743
.quad 0
.quad 0
.int 1404316229
.quad __Nodes + 360
.quad __Nodes + 340
.int -778490530
.quad __Nodes + 300
.quad 0
.int 2138007214
.quad 0
__Garbage_584389777: .byte 117, 229, 183, 249
root:
.quad __Nodes + 460
__Garbage_767714629: .byte 185, 131, 208
node:
.quad -1419987272
.int -275222966
.quad -1179562473
