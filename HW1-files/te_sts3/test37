.global _start

.section .text

  movq root, %rdi
  xor %r8, %r8
  movl __ExpectedArraySize, %r8d
  movq $__ExpectedArray, %r9
  movq $0, %r10
  call rec

  cmp %r10, %r8
  jne bad_exit
  
  movq $60, %rax
  movq $0, %rdi
  syscall

bad_exit:
  movq $60, %rax
  movq $1, %rdi
  syscall

rec:
  pushq %rdi
  movq (%rdi), %r11
  cmp $0, %r11
  je skip_left
  movq %r11, %rdi
  call rec
  movq (%rsp), %rdi
skip_left:
  cmpq %r8, %r10
  je bad_exit
  movl 8(%rdi), %eax
  movl (%r9, %r10, 4), %edx
  cmpl %eax, %edx
  jne bad_exit
  inc %r10

  movq 12(%rdi), %r11
  cmp $0, %r11
  je skip_right
  movq %r11, %rdi
  call rec
skip_right:
  popq %rdi
  ret


.section .data
__ExpectedArray: .int -1804115796, -1604316929, -1569691030, -1506683589, -1465747699, -1299353242, -1093489110, -985621179, -936114823, -866197971, -862453434, -765131251, -431275814, -198165145, 131208706, 274803851, 378284592, 630296002, 808588860, 860368167, 878777822, 1013410119, 1068949502, 1361022796, 1420178648, 1477654261, 1478158307, 1559234085, 2017517450, 2060740718
__Garbage_358692118: .byte 253, 132, 213, 167, 242, 130, 89, 25, 102, 7
__ExpectedArraySize: .int 30
__Garbage_201400174: .byte 174, 132, 250, 173, 4, 235, 183, 61
__Nodes:
.quad 0
.int 860368167
.quad 0
.quad __Nodes + 520
.int 131208706
.quad __Nodes + 360
.quad 0
.int 630296002
.quad 0
.quad 0
.int -1465747699
.quad __Nodes + 120
.quad __Nodes + 200
.int -1569691030
.quad 0
.quad __Nodes + 140
.int -1506683589
.quad __Nodes + 60
.quad 0
.int -1299353242
.quad 0
.quad 0
.int -1804115796
.quad __Nodes + 80
.quad 0
.int -198165145
.quad 0
.quad 0
.int -765131251
.quad 0
.quad 0
.int -1604316929
.quad 0
.quad 0
.int 1013410119
.quad __Nodes + 260
.quad 0
.int 1420178648
.quad __Nodes + 500
.quad 0
.int 1068949502
.quad 0
.quad __Nodes + 40
.int 808588860
.quad __Nodes + 0
.quad 0
.int 1477654261
.quad 0
.quad __Nodes + 400
.int -862453434
.quad __Nodes + 20
.quad __Nodes + 420
.int -936114823
.quad __Nodes + 380
.quad __Nodes + 560
.int 378284592
.quad __Nodes + 280
.quad __Nodes + 320
.int 878777822
.quad __Nodes + 220
.quad 0
.int -866197971
.quad 0
.quad __Nodes + 100
.int -1093489110
.quad __Nodes + 540
.quad __Nodes + 240
.int 2060740718
.quad 0
.quad __Nodes + 340
.int 1361022796
.quad __Nodes + 440
.quad __Nodes + 300
.int 1478158307
.quad 0
.quad __Nodes + 480
.int 2017517450
.quad 0
.quad __Nodes + 180
.int -431275814
.quad __Nodes + 160
.quad 0
.int -985621179
.quad 0
.quad 0
.int 274803851
.quad 0
__Garbage_146810964: .byte 179, 215
root:
.quad __Nodes + 460
__Garbage_394156684: .byte 82, 87, 150, 128, 201
node:
.quad -2142188771
.int 1559234085
.quad 1186240693
