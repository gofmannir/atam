.global _start

.section .text

  movq root, %rdi
  xor %r8, %r8
  movl __ExpectedArraySize, %r8d
  movq $__ExpectedArray, %r9
  movq $0, %r10
  call rec

  cmp %r10, %r8
  jne bad_exit
  
  movq $60, %rax
  movq $0, %rdi
  syscall

bad_exit:
  movq $60, %rax
  movq $1, %rdi
  syscall

rec:
  pushq %rdi
  movq (%rdi), %r11
  cmp $0, %r11
  je skip_left
  movq %r11, %rdi
  call rec
  movq (%rsp), %rdi
skip_left:
  cmpq %r8, %r10
  je bad_exit
  movl 8(%rdi), %eax
  movl (%r9, %r10, 4), %edx
  cmpl %eax, %edx
  jne bad_exit
  inc %r10

  movq 12(%rdi), %r11
  cmp $0, %r11
  je skip_right
  movq %r11, %rdi
  call rec
skip_right:
  popq %rdi
  ret


.section .data
__ExpectedArray: .int -1717697019, -1344607068, -1102863283, -752453583, -574266091, -162053938, -54652858, 511197692, 888791148, 939646930, 1004489166, 1113744826, 1425131619, 1432376328, 1444789319, 1541864367, 2105891035
__Garbage_381961548: .byte 188, 159, 8, 173, 230, 100, 64, 5, 99, 29
__ExpectedArraySize: .int 17
__Garbage_189683329: .byte 120, 238, 54, 105, 85, 66, 146, 200
__Nodes:
.quad __Nodes + 60
.int 1444789319
.quad __Nodes + 180
.quad 0
.int 1004489166
.quad 0
.quad 0
.int -1717697019
.quad __Nodes + 140
.quad __Nodes + 240
.int 1425131619
.quad __Nodes + 220
.quad 0
.int -574266091
.quad __Nodes + 260
.quad __Nodes + 120
.int 2105891035
.quad 0
.quad __Nodes + 160
.int 888791148
.quad __Nodes + 0
.quad 0
.int -1102863283
.quad 0
.quad __Nodes + 40
.int -752453583
.quad __Nodes + 300
.quad 0
.int 1541864367
.quad 0
.quad 0
.int 511197692
.quad 0
.quad 0
.int 1432376328
.quad 0
.quad 0
.int 939646930
.quad __Nodes + 280
.quad 0
.int -162053938
.quad 0
.quad __Nodes + 20
.int 1113744826
.quad 0
.quad __Nodes + 80
.int -54652858
.quad __Nodes + 200
__Garbage_471467095: .byte 166, 135
root:
.quad __Nodes + 100

node:
.quad -1903376609
.int -1344607068
.quad -1405706491
